---
title: "Benchmark: cut characters in bash"
layout: post
permalink: /2022/03/25/cut-characters-bash/
image: /wp-content/uploads/2022/03/benchmark.cut.jpg
categories:
    - bash
tags:
    - benchmark
    - awk
    - cut
    - bash-benchmark
    - shell
---
Post #1 in this [bash benchmark](/tag/bash-benchmark/) series, 
measuring the speed of common **bash text manipulations**.

## Cutting the first 20 characters from each line

> Update: I now have developed benchmarking for both **throughput** (MB/s) and **invocation** (ops/sec) speed in my project, combined with all kinds of other improvements, so the content in this article was updated [2022-04-08]

![Bash benchmarks](/wp-content/uploads/2022/03/benchmark.cut.jpg)

Imagine you want just the first 20 characters of a string , or of every line of a file. How would you do this in `bash`?

### Using `cut`
* the most common way to do this, is probably `cut -c1-20`
  (to cut the first 20 characters of every line, and delete the rest)

### Using `awk`
* another way is to use the swiss army knife of string/line manipulation **awk**: `awk '{print substr($0,1,20)}'`

### Using bash variable
* you could also do character cutting during variable expansion: `${variable:0:20}`

## Benchmark [via pforret/bash_benchmarks](https://github.com/pforret/bash_benchmarks) 

| method           | throughput   | invocation        |
|------------------|--------------|-------------------|
| awk              | 328 MB/s (!) | 247 ops/sec       |
| cut              | 43 MB/s      | 903 ops/sec       |
| ${line,,}        | 8 MB/s       | 10638 ops/sec (!) |

Some lessons from these benchmarks:
* `${line:0:20}` has low throughput because of the whole `while read -r line` construction, but the **invocation** speed is less than 100 nanoseconds (+-10600 ops/sec).
* `awk`'s **throughput** speed is almost 10 times faster than `cut`.

So what is my recommendation for **cutting N chars off**?
* if you need to cut the first chars of a small string, use `${string:0:<length>}`.
* if you need to cut the first chars of each line in a larger txt/csv file, use `awk`

More info: [pforret.github.io/bash_benchmarks/chars.html](https://pforret.github.io/bash_benchmarks/chars.html)